apiVersion: v1
kind: Pod
metadata:
  name: "{{ include "fullname" . }}-test-connection"
  labels:
    app: {{ template "fullname" . }}
  annotations:
    "helm.sh/hook": test
spec:
  containers:
    - name: wget
      image: busybox
      command: ['sh']
      args:
        - '-c'
        - |
          sleep 10;
          wget -O - {{ include "fullname" . }}:{{ .Values.service.servicePort }};
          sleep 10;
          wget -O - {{ include "fullname" . }}:{{ .Values.service.servicePort }};
    {{- if .Values.jaeger.enabled }}
    - name: wget-jaeger
      image: busybox
      command: ['sh']
      args:
        - '-c'
        - |
          sleep 10;
          wget -O - http://{{ include "fullname" . }}-jaeger:16686;
    {{- end }}
  restartPolicy: Never
